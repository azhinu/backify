<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Login Window</title>
    <script type="text/javascript" src="helper.js"></script>

    <script type='text/javascript'>//<![CDATA[

    let spotifyConfig;

    window.onload = function () {
        loadSpotifyConfig();
        console.log("WINDOW LOCATION");
        console.log(window.location);
        let target = window.self === window.top ? window.opener : window.parent;
        console.log("TARGET");
        console.log(target);
        let hash = window.location.hash;
        if (hash) {
            let token = window.location.hash.split('&')[0].split('=')[1];
            console.log("TOKEN");
            console.log(token);
            target.postMessage(token, spotifyConfig.uri);
        }
    };

    function loadSpotifyConfig() {
        XHR('config.json', function (response) {
            spotifyConfig = JSON.parse(response).spotifyConfig;
            console.log("LOADED CONFIG...");
            console.log(spotifyConfig);
        });
    }
    </script>
</head>
<body>

</body>
</html>


