<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Login Window</title>
    <script type="text/javascript" src="utils.js"></script>

    <script type='text/javascript'>//<![CDATA[

    let spotifyConfig;

    window.onload = function () {
        loadConfig(function () {
            let target = window.self === window.top ? window.opener : window.parent;
            let hash = window.location.hash;
            console.log('target -> ', target);
            console.log('hash -> ', hash);
            if (hash) {
                let token = window.location.hash.split('&')[0].split('=')[1];
                console.log('token -> ', token);
                target.postMessage(token, spotifyConfig.uri);
            }
        });
    };

    function loadConfig(callback) {
        XHR('config.json', function (response) {
            spotifyConfig = JSON.parse(response).spotifyConfig;
            callback();
        });
    }
    </script>
</head>
<body>

</body>
</html>


